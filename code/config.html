<html>
<head>
<title>Internode Usage Monitor - Settings</title>
<script>

var req; //global to give callbacks easy access to it

function saveConfig(form) {

    try {
        console.debug(form[0].value);
        chrome.extension.getBackgroundPage().setCredentials(form[0].value, form[1].value);    
        chrome.extension.getBackgroundPage().fetchCustomerID();    
    } catch(e) {
        console.error("Err:"+e);
    } finally {	
        return false; //stop an further event processing
    }
}


function run() {
     console.debug("u:"+window.localStorage.getItem("username"));

     if (window.localStorage.getItem("custID")) {
         chrome.extension.getBackgroundPage().fetchQuotaData();
         return;       
     }
     
     chrome.extension.getBackgroundPage().fetchCustomerID(
         chrome.extension.getBackgroundPage().saveCustID
     );
}




</script>
</head>

<body>
<form onsubmit="return saveConfig(this);"><label>Username</label><input
    type="text" name="username" /> <br />
<label>Password</label><input type="password" name="password" /> <br />
<input type="submit" value="Save" />
</form>

<input type="button" value="Run" onclick="return run();" />

</body>
</html>